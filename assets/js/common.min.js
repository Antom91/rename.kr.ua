$(function(){function e(e){var t=e,a={};t?(history.replaceState("","","?q="+t),$.each(n,function(e,n){$.each(n,function(n,i){if(i.old_name&&i.new_name){var s=i.old_name.toLowerCase().indexOf(t.toLowerCase())>=0,o=i.new_name.toLowerCase().indexOf(t.toLowerCase())>=0;(s||o)&&($.isEmptyObject(a[e])&&(a[e]=[]),a[e].push(i))}})}),a&&(html="",$.each(a,function(e,a){html+='<div class="table-row"><div class="left-hand" data-letter="'+e+'">'+e+'</div><div class="rigth-hand">',a&&$.each(a,function(e,a){var n=a.new_name,i=a.old_name,s=n.toLowerCase().indexOf(t.toLowerCase()),o=i.toLowerCase().indexOf(t.toLowerCase());s>=0&&(n=n.replace(new RegExp(n.substr(s,t.length),"i"),"<b>"+n.substr(s,t.length)+"</b>")),o>=0&&(i=i.replace(new RegExp(i.substr(o,t.length),"i"),"<b>"+i.substr(o,t.length)+"</b>")),html+='<div class="row"><div class="row-data"><a href="/street/view/id/'+a.id+'">'+i+'</a></div><div class="row-data">'+n+'</div><div class="row-data">'+(a.project?"<span style='color: #eb2a3c;'>Розглядається</span>":a.resolve_date)+"</div>";var l="";a.eponim&&$.each(["","Особа","Об’єкт","Історична назва","Суб’єкт"],function(e,t){a.eponim_type==e&&(l=a.eponim&&"історична назва"!=a.eponim?'<a href="'+a.eponim+'" target="__blank">'+t+"</a>":t)}),html+='<div class="row-data">'+l+"</div>",html+="</div>"}),html+="</div></div>"}),html&&($(".current_table").removeClass("now").hide(),$(".search_table").addClass("now").show().html(html)))):(history.replaceState("","","/"),$(".current_table").addClass("now").show(),$(".search_table").removeClass("now").hide())}function t(){var e=$(window).scrollTop(),t=$(".streets-table").offset().top;e+180>t?($("header").addClass("fixed animated fadeInDown"),$(".invisible-height").addClass("active")):($(".invisible-height").removeClass("active"),$("header").removeClass("fixed animated fadeInDown"));var a={};$(".left-hand").each(function(e,t){$(this).offset().top<$(window).scrollTop()+185&&(a[e]=$(this))});var n=a[Object.keys(a)[Object.keys(a).length-1]];n&&$(".current-letter").text()!=n.text()&&$(".current-letter").text(n.text())}function a(e){var t,a,n=decodeURIComponent(window.location.search.substring(1)),i=n.split("&");for(a=0;a<i.length;a++)if(t=i[a].split("="),t[0]===e)return void 0===t[1]?!0:t[1]}$(".main-menu li").hover(function(){$(".main-menu li").removeClass("active"),$(this).addClass("active")},function(){$(".main-menu li").removeClass("active"),$(".main-menu li[data-active=1]").addClass("active")}),$(document).on("click",".alphabet li a",function(e){e.preventDefault();var t=$(document).find('.now .left-hand[data-letter="'+$(this).text()+'"]'),a=t.offset().top;$("header").hasClass("fixed")&&(a-=183),t&&$("html, body").animate({scrollTop:a},2e3)});var n=!1;$("#responce").length&&(n=JSON.parse($("#responce").html()));var i=a("q"),s=$('input[name="search"]');i&&s.length&&(s.val(i),e(i)),n&&(t(),$(window).scroll(function(e){t()}),$(document).on("keyup",'input[name="search"]',function(t){t.preventDefault(),e($(this).val())}))});